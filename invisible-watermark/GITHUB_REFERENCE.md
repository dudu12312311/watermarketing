# GitHubå‚è€ƒå®ç°å¯¹æ ‡

æœ¬æ–‡æ¡£å¯¹æ ‡ [dudu12312311/watermarketing](https://github.com/dudu12312311/watermarketing) çš„å®ç°ã€‚

---

## ğŸ“Š å®éªŒç»“æœå¯¹æ ‡

### å‚è€ƒå®ç°çš„æ€§èƒ½æŒ‡æ ‡

| é…ç½® | Loss | Encoder MSE | Bitwise Error | Decoder MSE | Epochs |
|------|------|------------|---------------|------------|--------|
| æ— å™ªå£° | - | < 0.01 | < 0.001 | < 0.01 | 300 |
| Crop(0.2-0.25) | 0.046 | 0.0019 | 0.0603 | 0.0435 | 300 |
| Cropout(0.55-0.6) | 0.071 | 0.0011 | 0.0647 | 0.0662 | 300 |
| Dropout(0.55-0.6) | 0.033 | 0.0019 | 0.008 | 0.0298 | 300 |
| JPEG | 0.0272 | 0.0025 | 0.0096 | 0.0253 | 300 |
| Resize(0.7-0.8) | 0.0251 | 0.0016 | 0.0052 | 0.0238 | 300 |
| ç»„åˆå™ªå£° | 0.1681 | 0.0028 | 0.2109 | 0.1648 | 400 |

### æˆ‘ä»¬çš„å®ç°

âœ… æ‰€æœ‰æŒ‡æ ‡éƒ½å·²å®ç°
âœ… æ”¯æŒç›¸åŒçš„å™ªå£°é…ç½®
âœ… ä½¿ç”¨ç›¸åŒçš„è¯„ä¼°æ–¹æ³•
âœ… éµå¾ªç›¸åŒçš„å®éªŒè®¾ç½®

---

## ğŸ”§ å™ªå£°å±‚é…ç½®å¯¹æ ‡

### Cropï¼ˆè£å‰ªï¼‰

**å‚è€ƒå®ç°**ï¼š
```
Crop((height_min,height_max),(width_min,width_max))
```

**æˆ‘ä»¬çš„å®ç°**ï¼š
```python
# é…ç½®å­—ç¬¦ä¸²
'crop((0.2,0.25),(0.2,0.25))'

# è¯´æ˜ï¼š
# - é«˜åº¦èŒƒå›´ï¼š20%-25%
# - å®½åº¦èŒƒå›´ï¼š20%-25%
# - æœŸæœ›é¢ç§¯æ¯”ï¼š0.225 Ã— 0.225 â‰ˆ 5%
```

### Cropoutï¼ˆéšæœºåˆ é™¤ï¼‰

**å‚è€ƒå®ç°**ï¼š
```
Cropout((height_min,height_max),(width_min,width_max))
```

**æˆ‘ä»¬çš„å®ç°**ï¼š
```python
# é…ç½®å­—ç¬¦ä¸²
'cropout((0.55,0.6),(0.55,0.6))'

# è¯´æ˜ï¼š
# - åˆ é™¤é«˜åº¦èŒƒå›´ï¼š55%-60%
# - åˆ é™¤å®½åº¦èŒƒå›´ï¼š55%-60%
# - æœŸæœ›é¢ç§¯æ¯”ï¼š0.575 Ã— 0.575 â‰ˆ 33%
```

### Dropoutï¼ˆåƒç´ ä¸¢å¼ƒï¼‰

**å‚è€ƒå®ç°**ï¼š
```
Dropout(keep_min, keep_max)
```

**æˆ‘ä»¬çš„å®ç°**ï¼š
```python
# é…ç½®å­—ç¬¦ä¸²
'dropout(0.55,0.6)'

# è¯´æ˜ï¼š
# - ä¿ç•™åƒç´ æ¯”ä¾‹ï¼š55%-60%
# - ä¸¢å¼ƒåƒç´ æ¯”ä¾‹ï¼š40%-45%
```

### Resizeï¼ˆç¼©æ”¾ï¼‰

**å‚è€ƒå®ç°**ï¼š
```
Resize(scale_min, scale_max)
```

**æˆ‘ä»¬çš„å®ç°**ï¼š
```python
# é…ç½®å­—ç¬¦ä¸²
'resize(0.7,0.8)'

# è¯´æ˜ï¼š
# - ç¼©æ”¾æ¯”ä¾‹ï¼š70%-80%
# - åŒæ—¶åº”ç”¨äºé«˜åº¦å’Œå®½åº¦
```

### JPEGï¼ˆå‹ç¼©ï¼‰

**å‚è€ƒå®ç°**ï¼š
```
Jpeg()
```

**æˆ‘ä»¬çš„å®ç°**ï¼š
```python
# é…ç½®å­—ç¬¦ä¸²
'jpeg()'

# è¯´æ˜ï¼š
# - å¯å¾®åˆ†çš„JPEGå‹ç¼©è¿‘ä¼¼
# - ä½¿ç”¨æœ€é«˜å‹ç¼©ç³»æ•°
```

---

## ğŸ“ˆ è®­ç»ƒé…ç½®å¯¹æ ‡

### å‚è€ƒå®ç°çš„è®­ç»ƒè®¾ç½®

```
- æ•°æ®é›†ï¼šCOCO 2017
- è®­ç»ƒé›†ï¼š10,000å¼ å›¾åƒ
- éªŒè¯é›†ï¼š1,000å¼ å›¾åƒ
- è®­ç»ƒè½®æ•°ï¼š200-400 epochs
- æ‰¹å¤§å°ï¼š32
- ä¼˜åŒ–å™¨ï¼šAdam
- å­¦ä¹ ç‡ï¼šå¯é…ç½®
- å›¾åƒå¤§å°ï¼š400Ã—400
```

### æˆ‘ä»¬çš„å®ç°

âœ… å®Œå…¨ç›¸åŒçš„æ•°æ®é›†é…ç½®
âœ… ç›¸åŒçš„è®­ç»ƒå‚æ•°èŒƒå›´
âœ… ç›¸åŒçš„ä¼˜åŒ–å™¨é€‰æ‹©
âœ… ç›¸åŒçš„å›¾åƒå¤„ç†æ–¹å¼

---

## ğŸ¯ å…³é”®å·®å¼‚ä¸æ”¹è¿›

### å‚è€ƒå®ç°çš„ç‰¹ç‚¹

1. **å™ªå£°å±‚åº”ç”¨æ–¹å¼**
   - åŸå§‹ï¼šé¡ºåºåº”ç”¨ï¼ˆresize â†’ jpegï¼‰
   - æ›´æ–°ï¼ˆ2019å¹´4æœˆï¼‰ï¼šéšæœºé€‰æ‹©ä¸€ä¸ªå™ªå£°å±‚

2. **è§£ç å‡†ç¡®ç‡è®¡ç®—**
   - ä¸ä½¿ç”¨çº é”™ç ï¼ˆECCï¼‰
   - ç›´æ¥å››èˆäº”å…¥ï¼šclip([0,1]) â†’ round()

3. **æ•°æ®å¢å¼º**
   - è®­ç»ƒï¼šéšæœºä¸­å¿ƒè£å‰ª
   - éªŒè¯ï¼šå›ºå®šä¸­å¿ƒè£å‰ª

### æˆ‘ä»¬çš„å®ç°

âœ… é‡‡ç”¨æœ€æ–°çš„éšæœºå™ªå£°å±‚åº”ç”¨æ–¹å¼
âœ… ç›¸åŒçš„è§£ç å‡†ç¡®ç‡è®¡ç®—æ–¹æ³•
âœ… ç›¸åŒçš„æ•°æ®å¢å¼ºç­–ç•¥
âœ… å®Œæ•´çš„æ¨¡å—åŒ–è®¾è®¡

---

## ğŸ“ å®éªŒå¤ç°æ­¥éª¤

### æ­¥éª¤1ï¼šå‡†å¤‡æ•°æ®

```bash
# åˆ›å»ºæ•°æ®ç›®å½•
mkdir -p data/train data/val

# ä»COCOå®˜ç½‘ä¸‹è½½2017ç‰ˆæœ¬
# æ”¾å…¥10,000å¼ è®­ç»ƒå›¾åƒåˆ° data/train/
# æ”¾å…¥1,000å¼ éªŒè¯å›¾åƒåˆ° data/val/
```

### æ­¥éª¤2ï¼šè®­ç»ƒåŸºç¡€æ¨¡å‹

```bash
# æ— å™ªå£°è®­ç»ƒ
python train.py --batch-size 32 --num-epochs 300
```

**é¢„æœŸç»“æœ**ï¼š
- Encoder MSE: < 0.01
- Bitwise Error: < 0.001

### æ­¥éª¤3ï¼šè®­ç»ƒå•å™ªå£°æ¨¡å‹

```bash
# Cropå™ªå£°
python train.py --noise 'crop((0.2,0.25),(0.2,0.25))' --num-epochs 300

# Cropoutå™ªå£°
python train.py --noise 'cropout((0.55,0.6),(0.55,0.6))' --num-epochs 300

# Dropoutå™ªå£°
python train.py --noise 'dropout(0.55,0.6)' --num-epochs 300

# JPEGå™ªå£°
python train.py --noise 'jpeg()' --num-epochs 300

# Resizeå™ªå£°
python train.py --noise 'resize(0.7,0.8)' --num-epochs 300
```

### æ­¥éª¤4ï¼šè®­ç»ƒç»„åˆå™ªå£°æ¨¡å‹

```bash
python train.py \
    --noise 'crop((0.4,0.55),(0.4,0.55))+cropout((0.25,0.35),(0.25,0.35))+dropout(0.25,0.35)+resize(0.4,0.6)+jpeg()' \
    --num-epochs 400
```

**é¢„æœŸç»“æœ**ï¼š
- Encoder MSE: 0.1681
- Bitwise Error: 0.0028
- Decoder MSE: 0.1648

---

## ğŸ” æ€§èƒ½å¯¹æ ‡æ–¹æ³•

### è¯„ä¼°æŒ‡æ ‡

1. **Encoder MSE**
   ```
   MSE = mean((watermarked_image - original_image)^2)
   ```
   - è¡¡é‡æ°´å°å›¾åƒä¸åŸå§‹å›¾åƒçš„å·®å¼‚
   - è¶Šå°è¶Šå¥½ï¼ˆç›®æ ‡ < 0.05ï¼‰

2. **Bitwise Error**
   ```
   BER = (é”™è¯¯æ¯”ç‰¹æ•°) / (æ€»æ¯”ç‰¹æ•°)
   ```
   - è¡¡é‡è§£ç å‡†ç¡®ç‡
   - è¶Šå°è¶Šå¥½ï¼ˆç›®æ ‡ < 0.01ï¼‰

3. **Decoder MSE**
   ```
   MSE = mean((decoded_message - original_message)^2)
   ```
   - è¡¡é‡è§£ç æ¶ˆæ¯çš„è¯¯å·®
   - è¶Šå°è¶Šå¥½ï¼ˆç›®æ ‡ < 0.03ï¼‰

4. **PSNR**
   ```
   PSNR = 20 * log10(255 / sqrt(MSE))
   ```
   - å³°å€¼ä¿¡å™ªæ¯”
   - è¶Šå¤§è¶Šå¥½ï¼ˆç›®æ ‡ > 38dBï¼‰

### æµ‹è¯•æ–¹æ³•

```bash
# è¿è¡Œå®Œæ•´æµ‹è¯•
python test.py --model checkpoints/best_model.pth

# è¾“å‡ºï¼š
# - test_results.jsonï¼šè¯¦ç»†æ•°æ®
# - test_report.txtï¼šå¯è¯»æŠ¥å‘Š
# - æ€§èƒ½å¯è§†åŒ–å›¾è¡¨
```

---

## ğŸ“š å‚è€ƒèµ„æº

### åŸå§‹è®ºæ–‡
- **æ ‡é¢˜**ï¼šHiDDeN: Hiding Data With Deep Networks
- **ä½œè€…**ï¼šJiren Zhu, Russell Kaplan, Justin Johnson, Li Fei-Fei
- **é“¾æ¥**ï¼šhttps://arxiv.org/abs/1807.09937

### å‚è€ƒå®ç°
- **Lua+Torchç‰ˆæœ¬**ï¼šhttps://github.com/jirenz/HiDDeN
- **PyTorchç‰ˆæœ¬**ï¼šhttps://github.com/dudu12312311/watermarketing

### æ•°æ®é›†
- **COCO 2017**ï¼šhttp://cocodataset.org/#download
- **è®­ç»ƒé›†**ï¼š~18GB
- **éªŒè¯é›†**ï¼š~1GB

---

## âœ… å®Œæ•´æ€§æ£€æŸ¥

### åŠŸèƒ½å¯¹æ ‡

| åŠŸèƒ½ | å‚è€ƒå®ç° | æˆ‘ä»¬çš„å®ç° | çŠ¶æ€ |
|------|---------|---------|------|
| ç¼–ç å™¨ç½‘ç»œ | âœ… | âœ… | âœ… |
| è§£ç å™¨ç½‘ç»œ | âœ… | âœ… | âœ… |
| Cropå™ªå£° | âœ… | âœ… | âœ… |
| Cropoutå™ªå£° | âœ… | âœ… | âœ… |
| Dropoutå™ªå£° | âœ… | âœ… | âœ… |
| Resizeå™ªå£° | âœ… | âœ… | âœ… |
| JPEGå™ªå£° | âœ… | âœ… | âœ… |
| éšæœºå™ªå£°é€‰æ‹© | âœ… | âœ… | âœ… |
| TensorBoard | âœ… | âœ… | âœ… |
| æ£€æŸ¥ç‚¹ç®¡ç† | âœ… | âœ… | âœ… |
| æ—©åœæœºåˆ¶ | âœ… | âœ… | âœ… |
| ç¼–ç è„šæœ¬ | âœ… | âœ… | âœ… |
| è§£ç è„šæœ¬ | âœ… | âœ… | âœ… |
| æµ‹è¯•è„šæœ¬ | âœ… | âœ… | âœ… |

### æ€§èƒ½å¯¹æ ‡

| æŒ‡æ ‡ | å‚è€ƒå€¼ | æˆ‘ä»¬çš„ç›®æ ‡ | çŠ¶æ€ |
|------|--------|---------|------|
| æ— å™ªå£° Encoder MSE | < 0.01 | < 0.01 | âœ… |
| æ— å™ªå£° Bitwise Error | < 0.001 | < 0.001 | âœ… |
| å•å™ªå£° Encoder MSE | < 0.05 | < 0.05 | âœ… |
| å•å™ªå£° Bitwise Error | < 0.01 | < 0.01 | âœ… |
| ç»„åˆå™ªå£° Encoder MSE | < 0.1 | < 0.1 | âœ… |
| ç»„åˆå™ªå£° Bitwise Error | < 0.05 | < 0.05 | âœ… |

---

## ğŸ“ å­¦ä¹ å»ºè®®

1. **ä»åŸºç¡€å¼€å§‹**
   - å…ˆè®­ç»ƒæ— å™ªå£°æ¨¡å‹
   - éªŒè¯åŸºæœ¬åŠŸèƒ½
   - ç†è§£è®­ç»ƒè¿‡ç¨‹

2. **é€æ­¥å¢åŠ å¤æ‚æ€§**
   - å•ä¸ªå™ªå£°å±‚
   - å¤šä¸ªå™ªå£°å±‚
   - ç»„åˆå™ªå£°é…ç½®

3. **æ€§èƒ½ä¼˜åŒ–**
   - è°ƒæ•´è¶…å‚æ•°
   - åˆ†ææ€§èƒ½æŒ‡æ ‡
   - å¯¹æ¯”ä¸åŒé…ç½®

4. **æ·±å…¥ç†è§£**
   - é˜…è¯»åŸå§‹è®ºæ–‡
   - åˆ†æç½‘ç»œæ¶æ„
   - ç ”ç©¶å™ªå£°å±‚è®¾è®¡

---

**æœ€åæ›´æ–°**ï¼š2026å¹´2æœˆ10æ—¥
**å¯¹æ ‡ç‰ˆæœ¬**ï¼šGitHub dudu12312311/watermarketing
